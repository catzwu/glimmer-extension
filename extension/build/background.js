(()=>{let e=!0;chrome.runtime.onMessage.addListener(((s,c,a)=>{switch(console.log("Background received:",s.type),s.type){case"TOGGLE_ACTIVATION":e=s.isActive??!e,chrome.tabs.query({},(s=>{s.forEach((s=>{s.id&&chrome.tabs.sendMessage(s.id,{type:"EXTENSION_STATE",isActive:e}).catch((()=>{}))}))})),a({success:!0});break;case"GET_EXTENSION_STATE":a({isActive:e});break;case"ADD_HIGHLIGHT":c.tab&&chrome.runtime.sendMessage(s).catch((()=>{})),a({success:!0});break;default:a({error:"Unknown message type"})}return!0}))})();